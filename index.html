<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Form Sarana Mesin COU</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<style>
body{
  background:#f4f6f9;
}
.card{
  border-radius:16px;
}
.machine-card{
  background:#f8f9fa;
  border:1px dashed #ced4da;
  padding:15px;
  border-radius:12px;
  margin-bottom:10px;
}
</style>
</head>

<body>
<div class="container py-4">
  <div class="card shadow">
    <div class="card-header bg-primary text-white">
      <h5 class="mb-0"><i class="bi bi-clipboard-data"></i> Form Evaluasi Sarana Mesin COU</h5>
    </div>

    <div class="card-body">

      <!-- SECTION 1 -->
      <div class="text-center mb-4">
        <h4 class="fw-bold text-primary">
          <i class="bi bi-arrow-repeat"></i>
          UPDATE DATA MESIN OPERASIONAL COU
        </h4>
        <p class="text-muted">
          MHU • MSU • MPU
        </p>
      </div>
    <p class="small text-secondary">
      <strong>Keterangan:</strong><br>
      MHU = Mesin Hitung Uang Kertas (Kodok & Standing)<br>
      MSU = Mesin Sortir Uang Kertas<br>
      MPU = Mesin Pengikat Uang Kertas<br>
      MHUL = Mesin Mesin Hitung Uang Logam <br> 
    </p>
    <hr>
    <br>  

      <!-- SECTION 0 : REGION -->
      <div class="mb-3">
        <label class="form-label fw-bold">
          <i class="bi bi-map"></i> Region
        </label>
        <select id="region" class="form-select" required>
          <option value="">-- Pilih Region --</option>
          <option>Region 1</option>
          <option>Region 2</option>
          <option>Region 3</option>
          <option>Region 4</option>
          <option>Region 5</option>
          <option>Region 6</option>
          <option>Region 7</option>
          <option>Region 8</option>
          <option>Region 9</option>
          <option>Region 10</option>
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label fw-bold">
          <i class="bi bi-person-badge"></i> Nama COU
        </label>
        <input type="text" id="namaCOU" class="form-control" required>
      </div>

      <!-- SECTION 2 -->
      <h6 class="fw-bold mt-4">
        <i class="bi bi-cpu"></i> Data Mesin
      </h6>

      <div id="mesinContainer"></div>

      <button class="btn btn-outline-primary btn-sm mt-2" onclick="tambahMesin()">
        <i class="bi bi-plus-circle"></i> Tambah Data Mesin
      </button>
      <br> <br> 

      <!-- SECTION 3 -->
      <div class="mt-4">
        <label class="form-label fw-bold">
          <i class="bi bi-question-circle"></i>
          Apakah sarana mesin sudah cukup?
        </label>
        <select id="kecukupan" class="form-select">
          <option value="Cukup">Cukup</option>
          <option value="Kurang">Kurang</option>
        </select>
      </div>

      <!-- SECTION 4 -->
      <div class="mt-3">
        <label class="form-label fw-bold">
          <i class="bi bi-chat-left-text"></i> Saran / Usulan
        </label>
        <textarea id="saran" class="form-control" rows="3"></textarea>
      </div>

    </div>

    <div class="card-footer text-end">
      <button class="btn btn-success" onclick="simpanData()">
        <i class="bi bi-save"></i> Save Data
      </button>
    </div>
  </div>
</div>

<script>
const webAppURL = "https://script.google.com/macros/s/AKfycbwtyrgJxW4pROH6RPfN_AgKSBTAz5ihLGix0ZmQ_u8RPiszXtSl9dCVLm2SBBPIE9bZag/exec";

function tambahMesin() {
  const div = document.createElement("div");
  div.className = "machine-card";

  div.innerHTML = `
    <div class="row g-2">
      <div class="col-md-3">
        <select class="form-select jenis">
          <option>MHU</option>
          <option>MSU</option>
          <option>MPU</option>
          <option>MHUL</option>
          <option>Lainnya</option>
        </select>
      </div>

      <div class="col-md-3">
        <select class="form-select merk">
          <option>Norxel</option>
          <option>Glory</option>
          <option>Hitachi</option>
          <option>Tronix</option>
          <option>GND</option>
          <option>Lainnya</option>
        </select>
      </div>

        <div class="col-md-3">
          <select class="form-select type">
            <option>Norxel-DLRX-7500</option>
            <option>Norxel-DLRX-5500</option>
            <option>Norxel-NX-9300</option>
            <option>Norxel-NX-7700</option>
            <option>Norxel-NX-5500HS</option>
          
            <option>Glory-UW-F8</option>
            <option>Glory-UW-600</option>
            <option>Glory-UW-500</option>
            <option>Glory-UW-F4</option>
            <option>Glory-USF-100</option>
            <option>Glory-USF-52</option>
            <option>Glory-GFB-800</option>
            <option>Glory-GNH-710</option>
          
            <option>Hitachi-MS-4200</option>
            <option>Hitachi-iH-210</option>
            <option>Hitachi-iH-110F</option>
          
            <option>Tronix-ST-150NF</option>
            <option>Tronix-TX-100</option>
            <option>Tronix-SH-07P</option>
          
            <option>GnD-C4</option>
            <option>GnD-C6</option>
            <option>GnD-C1</option>
          
            <option>Scan Coin-SC-360</option>
            <option>Cash Tek-ST-25</option>
            <option>LEA-BM-100</option>
            <option>Cash Quip-HL-3300</option>
          </select>

      <div class="col-md-3">
        <input class="form-control sn" placeholder="Serial Number">
      </div>
    </div>
  `;

  document.getElementById("mesinContainer").appendChild(div);
}

function simpanData() {
  const mesin = [];
  document.querySelectorAll(".machine-card").forEach(card => {
    mesin.push({
      jenis: card.querySelector(".jenis").value,
      merk: card.querySelector(".merk").value,
      type: card.querySelector(".type").value,
      sn: card.querySelector(".sn").value
    });
  });


    const payload = {
    region: document.getElementById("region").value,
    nama_cou: document.getElementById("namaCOU").value,
    kecukupan: document.getElementById("kecukupan").value,
    saran: document.getElementById("saran").value,
    mesin: mesin
};



  fetch(webAppURL, {
    method: "POST",
    body: JSON.stringify(payload)
  })
  .then(r => r.json())
  .then(res => {
    alert("Data berhasil disimpan!");
    location.reload();
  })
  .catch(err => alert("Gagal menyimpan data"));
}

// default 1 mesin
tambahMesin();
</script>

</body>
</html>
